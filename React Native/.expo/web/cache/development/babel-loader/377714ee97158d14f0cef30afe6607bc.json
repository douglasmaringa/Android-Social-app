{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\n\nvar _extraReducers;\n\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport { createSlice, createAsyncThunk } from \"@reduxjs/toolkit\";\nimport axios from \"axios\";\nexport var getUsers = createAsyncThunk(\"users/getUsers\", function _callee(_ref, dispatch, getState) {\n  var username, password;\n  return _regeneratorRuntime.async(function _callee$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          username = _ref.username, password = _ref.password;\n          console.log(username);\n          _context.prev = 2;\n          _context.next = 5;\n          return _regeneratorRuntime.awrap(axios.post(\"http://localhost:8800/api/auth/login\", {\n            email: username,\n            password: password\n          }));\n\n        case 5:\n          return _context.abrupt(\"return\", _context.sent);\n\n        case 8:\n          _context.prev = 8;\n          _context.t0 = _context[\"catch\"](2);\n          return _context.abrupt(\"return\", _context.t0);\n\n        case 11:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  }, null, null, [[2, 8]], Promise);\n});\nvar initialUser = localStorage.getItem('user') ? JSON.parse(localStorage.getItem('user')) : null;\nvar initialId = localStorage.getItem('id') ? JSON.parse(localStorage.getItem('id')) : null;\nvar initialUsername = localStorage.getItem('username') ? JSON.parse(localStorage.getItem('username')) : null;\nvar usersSlice = createSlice({\n  name: \"user\",\n  initialState: {\n    users: [],\n    status: null,\n    email: initialUser,\n    id: initialId,\n    username: initialUsername\n  },\n  reducers: {\n    logoutSuccess: function logoutSuccess(state, action) {\n      state.email = null;\n      state.users = [];\n      localStorage.removeItem('user');\n      localStorage.removeItem('id');\n      localStorage.removeItem('username');\n    }\n  },\n  extraReducers: (_extraReducers = {}, _defineProperty(_extraReducers, getUsers.pending, function (state, action) {\n    state.status = \"loading\";\n  }), _defineProperty(_extraReducers, getUsers.fulfilled, function (state, action) {\n    state.status = \"success\";\n    state.users = action.payload;\n\n    if (action.payload.status == 200) {\n      localStorage.setItem('user', JSON.stringify(action.payload.data.email));\n      localStorage.setItem('id', JSON.stringify(action.payload.data._id));\n      localStorage.setItem('username', JSON.stringify(action.payload.data.username));\n    } else {\n      alert(\"wrong credentials\");\n    }\n  }), _defineProperty(_extraReducers, getUsers.rejected, function (state, action) {\n    state.status = \"failed\";\n  }), _extraReducers)\n});\nvar logoutSuccess = usersSlice.actions.logoutSuccess;\nexport var logout = function logout() {\n  return function _callee2(dispatch) {\n    return _regeneratorRuntime.async(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            _context2.prev = 0;\n            alert(\"logout sucees\");\n            return _context2.abrupt(\"return\", dispatch(logoutSuccess()));\n\n          case 5:\n            _context2.prev = 5;\n            _context2.t0 = _context2[\"catch\"](0);\n            return _context2.abrupt(\"return\", console.error(_context2.t0.message));\n\n          case 8:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, [[0, 5]], Promise);\n  };\n};\nexport default usersSlice.reducer;","map":{"version":3,"sources":["C:/Users/DOUGLAS/Desktop/ReactNative/letsgo/lets-go/slice/UserSlice.js"],"names":["createSlice","createAsyncThunk","axios","getUsers","dispatch","getState","username","password","console","log","post","email","initialUser","localStorage","getItem","JSON","parse","initialId","initialUsername","usersSlice","name","initialState","users","status","id","reducers","logoutSuccess","state","action","removeItem","extraReducers","pending","fulfilled","payload","setItem","stringify","data","_id","alert","rejected","actions","logout","error","message","reducer"],"mappings":"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","sourcesContent":["import { createSlice, createAsyncThunk } from \"@reduxjs/toolkit\";\r\nimport axios from \"axios\"\r\n\r\n//action for getting user\r\nexport const getUsers = createAsyncThunk(\r\n  \"users/getUsers\",\r\n  async ({username,password},dispatch, getState) => {\r\n   console.log(username)\r\n    try{\r\n    return await axios.post(\"http://localhost:8800/api/auth/login\",{\r\n      email:username,\r\n      password:password\r\n    })\r\n    }catch(err){\r\n     return err;\r\n    }\r\n  }\r\n);\r\n\r\n\r\nconst initialUser = localStorage.getItem('user')\r\n  ? JSON.parse(localStorage.getItem('user'))\r\n  : null\r\n\r\n  const initialId = localStorage.getItem('id')\r\n  ? JSON.parse(localStorage.getItem('id'))\r\n  : null\r\n\r\n  const initialUsername = localStorage.getItem('username')\r\n  ? JSON.parse(localStorage.getItem('username'))\r\n  : null\r\n//State\r\nconst usersSlice = createSlice({\r\n  name: \"user\",\r\n  initialState: {\r\n    users: [],\r\n    status: null,\r\n    email:initialUser,\r\n    id:initialId,\r\n    username:initialUsername\r\n  },\r\n  //normal reducers come here\r\n  reducers:{  \r\n    logoutSuccess: (state, action) =>  {\r\n      state.email = null;\r\n      state.users= [];\r\n      localStorage.removeItem('user')\r\n      localStorage.removeItem('id')\r\n      localStorage.removeItem('username')\r\n    },\r\n  },\r\n  //reducers for thunk axios call come here\r\n  extraReducers: {\r\n    [getUsers.pending]: (state, action) => {\r\n      state.status = \"loading\";\r\n    },\r\n    [getUsers.fulfilled]: (state, action) => {\r\n      state.status = \"success\";\r\n      state.users = action.payload;\r\n      if(action.payload.status == 200){\r\n      localStorage.setItem('user', JSON.stringify(action.payload.data.email))\r\n      localStorage.setItem('id', JSON.stringify(action.payload.data._id))\r\n      localStorage.setItem('username', JSON.stringify(action.payload.data.username))\r\n    }\r\n    else{\r\n      alert(\"wrong credentials\")\r\n    }\r\n  },\r\n    [getUsers.rejected]: (state, action) => {\r\n      state.status = \"failed\";\r\n    }\r\n  },\r\n});\r\n\r\n//logout this is a normal action so it must be defined first\r\n// Actions\r\nconst {logoutSuccess } = usersSlice.actions\r\nexport const logout = () => async dispatch => {\r\n  try {\r\n    // await api.post('/api/auth/logout/')\r\n    alert(\"logout sucees\")\r\n    return dispatch(logoutSuccess())\r\n  } catch (e) {\r\n    return console.error(e.message);\r\n  }\r\n}\r\nexport default usersSlice.reducer;"]},"metadata":{},"sourceType":"module"}